#include "Types.h"

void leitura_string(char *ptr, int tamanho_vetor);
void perfumaria_linha(void);
void retirar_enter(char *ptr);
void formatar_maiusculo(char *ptr);
void scanf_melhorado_simples(char tipo, void *destino);
void limpar_tela(void);
void mostar_msg(char *msg);



int escolha_fabricante(void);
int escolha_tipo(void);
void mostrar_fabricantes(void);
void gerar_identificacao_nave(void);

#include "../include/Relatorio.h"
/*
    Relatórios de aeronaves
*/

//Função base para exibição de aeronaves
void informacao_aeronave(const aeronave_t* const aeronave)
{
    if(aeronave == NULL){
        printf("A aeronave procurada não esta cadastrada!\n");
        return;
    }

    printf("Identificação..........................: %i\n", aeronave->Identificacao);
    
    printf("Modelo.................................: %s\n", aeronave->Modelo);

    printf("Fabricante.............................: %s\n", fabricantes_Nave);

    printf("Matrícula..............................: %s\n", aeronave->Matricula);
    
    printf("Ano de fabricação......................: %i\n", aeronave->Ano_fabricacao);
    
    printf("Tipo...................................: %s\n", tipo_Nave[aeronave->Tipo]);
    
    printf("Número de passageiros que transporta...: %i\n", aeronave->Numero_passageiros);
    
    printf("Situação...............................: em %s\n", situacao_Nave[aeronave->Situacao]);

    printf("Tripulação necessária..................: %i\n", aeronave->Tripulacao_necessaria);
}

aeronave_t* buscar_nave_prefixo(lista_rotas_t *Primeiro, char *matricula_buscada)
{
    for(Primeiro; Primeiro != NULL; Primeiro = Primeiro->Proximo){
        if(strcmp(Primeiro->Matricula, matricula_buscada) == 0){
            return Primeiro;
        }
    }
    return NULL;
}



/*
    Relatórios de rotas
*/

//Função base para exibição de rotas
void informacao_rota(const rotas_t * const rota)
{
    printf("Código da rota.......................: %i\n", rota->Codigo);

    printf("Data.................................: %i/%i/%i\n", rota->Data->Dia, rota->Data->Mes, rota->Data->Ano);
    printf("Hora.................................: %i:%i:%i\n", rota->Horario->Hora, rota->Horario->Minuto, rota->Horario->Segundo);

    printf("Local de partida (origem)............: %s\n", rota->Local_partida);

    printf("Local de destino (destino)...........: %s\n", rota->Local_destino);

    printf("Tempo estimado de voo................: %i:%i:%i\n",  rota->Tempo_estimado_voo->Hora, rota->Tempo_estimado_voo->Minuto, rota->Tempo_estimado_voo->Segundo);

    printf("Combustível necessário (em litros)...: %.2f\n", rota->Combustivel_necessario);

    printf("Quantidade de passageiros............: %i\n", rota->Quantidade_passageiros);

    printf("Quantidade de carga útil.............: %.2f\n", rota->Quantidade_carga);

    mostrar_membros_tripulacao(rota);

    printf("Aeronave alocada (código)............: %i\n", rota->Aeronave_alocada);
}




int menu()
{
    int opcao;
    printf("1.Menu - Aeronaves;\n");
    printf("2.Menu - Rotas;\n");
    printf("0.Sair do programa;\n");
    scanf_melhorado_simples('i', &opcao);  
    if(opcao > 2 || opcao < 0){
        printf("Esta opcao nao eh valida!\n");
        return;
    }
    else{
        
    }
}

int sub_menu_aeronave()
{
    int opcao; 

    printf("1.Cadastro de aeronaves; \n");
    printf("2.Relatório de aeronaves; \n");
    printf("3.Busca de aeronave por prefixo; \n");
    printf("4.Listar aeronaves por fabricante; \n");
    printf("5.Listar aeronaves por tipo (carga ou passageiro); \n");
    printf("6.Listar aeronaves por modelo; \n");
    printf("7.Listar aeronaves por ano de fabricação; \n");
    printf("8.Listar aeronaves por situação (em operação ou em manutenção); \n");
    printf("9.Alterar Situação da aeronave;\n");
    printf("10.Quantidade de vezes que uma determinada aeronave entrou em manutenção; \n");
    printf("0.Voltar;\n");
    scanf_melhorado_simples('i', &opcao);  
    
    if(opcao > 10 || opcao < 0){
        printf("Esta opcao nao eh valida!\n");
        return;
    }
    return opcao; 
}

int sub_menu_rota()
{
    int opcao;

    printf("1.Cadastro de rotas; \n");
    printf("2.Consultar rota por data; \n");
    printf("3.Listar rotas por destino; \n");
    printf("4.Listar rotas por origem; \n");
    printf("5.Percentual de voos realizados para um determinado destino em um intervalo de datas; \n");
    printf("6.Percentual de voos realizados por aeronave; \n");
    printf("7.Consumo de combustível total em um intervalo de datas; \n");
    printf("8.Listar rotas com maior número de passageiros; \n");
    printf("9.Listar rotas com menor número de passageiros; \n");
    printf("0.Voltar;\n");
    scanf_melhorado_simples('i', &opcao);
    
    if(opcao > 9 || opcao < 0){
        printf("Esta opcao nao eh valida!\n");
        return;
    }
    return opcao;
    
}
#include "Cadastro.h"


void gerenciamento_aeronaves(int opcao, aeronave_t **Frota_naves, int *id_ultimo)
{

     switch (opcao) {    
            case 1: inserir_lista_fim_nave(&Frota_naves, cadastro_aeronave(&Frota_naves.Contador));
                    break;
            case 2: 
                    break;

            case 3: 
                    break;

            case 4:
                    break;

            case 5: 
                    break;

            case 6:
                    break;

            case 7: 
                    break;

            case 8:
                    break;
            
            case 9: 
                    break;

            case 10:
                    break;
        
        }
            
}

void gerenciamento_rotas(int opcao, rotas_t **Lista_rotas, int *id_ultimo)
{

    switch (opcao) {
        case 1: inserir_lista_fim_rota(&Lista_rotas, cadastro_rota(&Lista_rotas.Contador));
                break;

        case 2: 
                break;

        case 3: 
                break;

        case 4: 
                 break;

        case 5:
                break;

        case 6: 
                break;

        case 7: 
                break;

        case 8: 
                break;

        case 9: 
                break;
    }
}

#include "../include/Cadastro.h"

void inicializar_lista_nave(lista_naves_t *lista)
{
    lista->Primeiro = NULL;
    lista->Ultimo = NULL;
    lista->Contador = 0;
}
void inicializar_lista_rota(lista_rotas_t *lista)
{
    lista->Primeiro = NULL;
    lista->Ultimo = NULL;
    lista->Contador = 0;
}


aeronave_t *cadastro_aeronave(unsigned int *id_nave)
{
    aeronave_t *aeronave = NULL;

    aeronave = (aeronave_t*)malloc(sizeof(aeronave_t));

    printf("A identificacao da aeronave é: %i\n", *id_nave);

    perfumaria_linha();

    printf("Digite o modelo da aeronave:\n");
    leitura_string(aeronave->Modelo, SIZE_STR_1);

    perfumaria_linha();

    printf("Digite a fabricante da aeronave:\n");
    mostrar_fabricantes();
    scanf_melhorado_simples('i', &aeronave->Fabricante);  

    perfumaria_linha();

    printf("Digite a matrícula da aeronave:\n");
    leitura_string(aeronave->Matricula, SIZE_STR_1);

    perfumaria_linha();

    printf("Digite o ano de fabricacao da aeronave:\n");
    scanf_melhorado_simples('i', &aeronave->Ano_fabricacao);

    perfumaria_linha();

    printf("Digite o tipo da aeronave:\n");
    printf("Digite 0 se ela for para transporte de carga.\n");
    printf("Digite 1 se ela for para transporte de passageiros.\n");
    scanf_melhorado_simples('i', &aeronave->Tipo);

    perfumaria_linha();

    printf("Digite o número de passageiros que a aeronave transporta:\n");
    scanf_melhorado_simples('i', &aeronave->Numero_passageiros);

    perfumaria_linha();

    printf("Digite a situacao da aeronave:\n");
    printf("Digite 0 se ela estiver em manutencao.\n");
    printf("Digite 1 se ela estiver em operacao.\n");
    scanf_melhorado_simples('i', &aeronave->Situacao);

    perfumaria_linha();

    printf("Digite a tripulacao necessária para a operar a aeronave:\n");
    scanf_melhorado_simples('i', &aeronave->Tripulacao_necessaria);

    if (!aeronave.Situacao){
        aeronave->Qtd_manutencao = 1;
    }
    else{
        aeronave->Qtd_manutencao = 0;
    }

    aeronave->Proximo = NULL;
    *id_nave += 1;

    return aeronave;
}

rotas_t *cadastro_rota(unsigned int *id_rota)
{
    rotas_t *rota;
    
    rota = (rotas_t*)malloc(sizeof(rotas_t));
    
    printf("O código da rota é...........................: %i", *id_rota);
    
    printf("Data de partida(dd/mm/aaaa)..................: ");
    scanf("%i/%i/%i", &rota->Data->Dia, &rota->Data->Mes, &rota->Data->Ano);
    getchar();
    printf("Hora de partida(hh:mm:ss)....................: ");
    scanf("%i:%i:%i", &rota->Horario->Hora, &rota->Horario->Minuto, &rota->Horario->Segundo);
    getchar();
    
    printf("Digite o local de partida (origem)...........: ");
    leitura_string(rota->Local_partida, SIZE_STR_2);
    
    printf("Digite o local de destino (destino)..........: ");
    leitura_string(rota->Local_destino, SIZE_STR_2);
    
    printf("Digite o tempo estimado de voo (hh:mm:ss)....: ");
    scanf("%i:%i:%i", &rota->Tempo_estimado_voo->Hora, &rota->Tempo_estimado_voo->Minuto, &rota->Tempo_estimado_voo->Segundo);
    getchar();

    printf("Digite o combustível necessário (em litros)..: ");
    scanf_melhorado_simples('f', &rota->Combustivel_necessario);

    printf("Digite a quantidade de passageiros...........: ");
    scanf_melhorado_simples('i', &rota->Quantidade_passageiros);

    printf("Digite a quantidade de carga útil............: ");
    scanf_melhorado_simples('f', &rota->Quantidade_carga);

    printf("Digite o nome dos membros da tripulação......: ");
    cadastro_membros_tripulacao(&rota);

    printf("Digite a aeronave alocada (código)...........: ");
    scanf_melhorado_simples('i', &rota->Aeronave_alocada);
    
    rota->Proximo = NULL;
    *id_rota += 1; 

    return rota;
}

void inserir_lista_fim_nave(lista_naves_t *lista, aeronave_t *novo_elemento)
{   
    if (lista->Ultimo == NULL) {
        lista->Primeiro = novo_elemento;
        lista->Ultimo = novo_elemento;
    }
    else {
        lista->fim->Proximo = novo_elemento;
        lista->fim = novo_elemento;
    }
}

void inserir_lista_fim_rota(lista_rotas_t *lista, rotas_t *novo_elemento)
{
    if (lista->Ultimo == NULL){
        lista->Primeiro = novo_elemento;
        lista->Ultimo = novo_elemento;
    }
    else{
        lista->fim->Proximo = novo_elemento;
        lista->fim = novo_elemento;
    }
}


#include "Types.h"

/*
    RELATORIOS DE AERONAVES
*/

void informacao_aeronave(const aeronave_t* const aeronave);
void buscar_nave_prefixo(lista_rotas_t *Primeiro, char *matricula_buscada);//modificar para usar o total de naves cadastradas
void listagem_aeronave_fabricante(aeronave_t *nave, int naves_cadast, int fabricante);
void listagem_aeronave_tipo(aeronave_t *nave, int naves_cadast, int tipo);
void listagem_aeronave_modelo(aeronave_t *nave, int naves_cadast, char *modelo);
void listagem_aeronave_ano(aeronave_t *nave, int naves_cadast, int ano);
void listagem_aeronave_situacao(aeronave_t *nave, int naves_cadast, int situacao);
void quantidade_manutencoes_nave(aeronave_t *nave, int codigo, int naves_cadast);
void mostrar_membros_tripulacao(rotas_t *rota);



/*
    RELATORIOS DE ROTAS
*/

void informacao_rota(const rotas_t * const rota);
void listagem_rota_data(rotas_t *rota, int rotas_cadast, int *data);
void listagem_rota_destino(rotas_t *rota, int rotas_cadast, char *destino);
void listagem_rota_origem(rotas_t *rota, int rotas_cadast, char *origem);
void percentual_voo_destino_intervalo_data(rotas_t *rota, int rotas_cadast, char *destino, int *data_inicio, int *data_fim);
void percentual_voo_aeronave(rotas_t *rota, int rotas_cadast);
void total_combustivel_intervalo_data(rotas_t *rota, int rotas_cadast, int *data_inicio, int *data_fim);
void rota_mais_passageiros(rotas_t *rota, int rotas_cadast);
void rota_menos_passageiros(rotas_t *rota, int rotas_cadast);


int menu(void);
int sub_menu_aeronave(void);
int sub_menu_rota(void);
void sub_menu_saida(/*----------*/);


void alterar_situacao_nave(aeronave_t *nave, int codigo, int naves_cadast);


void gerenciamento_aeronaves(int opcao, aeronave_t **Frota_naves, int *id_ultimo);
void gerenciamento_rotas(int opcao, rotas_t **Lista_rotas, int *id_ultimo);


#include "Types.h"

void inicializar_lista_nave(lista_naves_t *lista);
void inicializar_lista_rota(lista_rotas_t *lista);

aeronave_t *cadastro_aeronave(void);
rotas_t *cadastro_rota(void);


void cadastro_membros_tripulacao(rotas_t *rota);

void inserir_lista_fim_nave(aeronave_t **Primeiro, aeronave_t *novo_elemento);
void inserir_lista_fim_rota(rotas_t **Primeiro, rotas_t *novo_elemento);
